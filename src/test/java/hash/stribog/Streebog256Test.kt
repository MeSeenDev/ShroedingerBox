package hash.stribog

import org.junit.jupiter.api.Assertions.assertArrayEquals
import org.junit.jupiter.api.Test

internal class Streebog256Test {

    private val testIn = byteArrayOf(
        0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37,
        0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31,
        0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35,
        0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30
    )

    private val testOut256 = byteArrayOf(
        0x00.toByte(), 0x55.toByte(), 0x7B.toByte(), 0xE5.toByte(), 0xE5.toByte(), 0x84.toByte(),
        0xFD.toByte(), 0x52.toByte(), 0xA4.toByte(), 0x49.toByte(), 0xB1.toByte(), 0x6B.toByte(),
        0x02.toByte(), 0x51.toByte(), 0xD0.toByte(), 0x5D.toByte(), 0x27.toByte(), 0xF9.toByte(),
        0x4A.toByte(), 0xB7.toByte(), 0x6C.toByte(), 0xBA.toByte(), 0xA6.toByte(), 0xDA.toByte(),
        0x89.toByte(), 0x0B.toByte(), 0x59.toByte(), 0xD8.toByte(), 0xEF.toByte(), 0x1E.toByte(),
        0x15.toByte(), 0x9D.toByte()
    )

    @Test
    fun computeHash() {
        val bytes = Streebog256().computeHash(testIn)
        assertArrayEquals(testOut256, bytes)
    }
}