package hash.stribog

import org.junit.jupiter.api.Assertions
import org.junit.jupiter.api.Test

internal class Streebog512Test {

    private val testIn = byteArrayOf(
        0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37,
        0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31,
        0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35,
        0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30
    )

    private val testOut512 = byteArrayOf(
        0x48.toByte(), 0x6F.toByte(), 0x64.toByte(), 0xC1.toByte(), 0x91.toByte(), 0x78.toByte(), 0x79.toByte(),
        0x41.toByte(), 0x7F.toByte(), 0xEF.toByte(), 0x08.toByte(), 0x2B.toByte(), 0x33.toByte(), 0x81.toByte(),
        0xA4.toByte(), 0xE2.toByte(), 0x11.toByte(), 0xC3.toByte(), 0x24.toByte(), 0xF0.toByte(), 0x74.toByte(),
        0x65.toByte(), 0x4C.toByte(), 0x38.toByte(), 0x82.toByte(), 0x3A.toByte(), 0x7B.toByte(), 0x76.toByte(),
        0xF8.toByte(), 0x30.toByte(), 0xAD.toByte(), 0x00.toByte(), 0xFA.toByte(), 0x1F.toByte(), 0xBA.toByte(),
        0xE4.toByte(), 0x2B.toByte(), 0x12.toByte(), 0x85.toByte(), 0xC0.toByte(), 0x35.toByte(), 0x2F.toByte(),
        0x22.toByte(), 0x75.toByte(), 0x24.toByte(), 0xBC.toByte(), 0x9A.toByte(), 0xB1.toByte(), 0x62.toByte(),
        0x54.toByte(), 0x28.toByte(), 0x8D.toByte(), 0xD6.toByte(), 0x86.toByte(), 0x3D.toByte(), 0xCC.toByte(),
        0xD5.toByte(), 0xB9.toByte(), 0xF5.toByte(), 0x4A.toByte(), 0x1A.toByte(), 0xD0.toByte(), 0x54.toByte(),
        0x1B.toByte()
    )

    @Test
    fun hashCore() {
        val bytes = Streebog512().computeHash(testIn)
        Assertions.assertArrayEquals(testOut512, bytes)
    }
}